<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Spotify Portfolio</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-logo">
                <span>♪</span>
                Spotify Portfolio
            </div>
            <div class="nav-actions">
                <a href="/logout" class="btn" style="padding: 12px 20px; font-size: 0.9rem; background: linear-gradient(45deg, #666, #888); margin-right: 10px;">
                    🚪 Logout
                </a>
                <button onclick="deleteUser()" class="btn delete-btn" style="padding: 12px 20px; font-size: 0.9rem;">
                    🗑️ Delete Account
                </button>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="welcome-card">
            <div class="welcome-header">
                <div class="avatar">
                    {{ user.name[0].upper() if user.name else 'U' }}
                </div>
                <div class="welcome-text">
                    <h1>Welcome back, {{ user.name or 'Music Lover' }}!</h1>
                    <p>Ready to explore your musical journey?</p>
                </div>
            </div>
            
            <div class="user-details">
                <div class="detail-item">
                    <div class="detail-label">Spotify ID</div>
                    <div class="detail-value">{{ user.spotify_id }}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Member Since</div>
                    <div class="detail-value">{{ user.created_at.strftime('%B %d, %Y') }}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Last Login</div>
                    <div class="detail-value">{{ user.created_at.strftime('%I:%M %p') }}</div>
                </div>
            </div>
        </div>

        <div class="actions-section">
            <h2 class="section-title">Discover Your Music</h2>
            <div class="action-buttons">
                <button onclick="getTopTracks()" class="btn">
                    🎵 Get My Top Tracks
                </button>
                <button onclick="getTopArtists()" class="btn">
                    🎤 Get My Top Artists
                </button>
                <button onclick="getTopGenres()" class="btn">
                    🎨 Get My Top Genres
                </button>
                <button onclick="getAvgPopularity()" class="btn">
                    📊 Get My Popularity Score
                </button>
            </div>
        </div>
        
        <div id="tracks-data" class="data-section">
            <div class="data-header">
                🎵 Your Top Tracks
            </div>
            <div class="data-content">
                <div id="tracks-loading" class="loading">
                    <div class="spinner"></div>
                    Loading your top tracks...
                </div>
                <div id="tracks-list"></div>
            </div>
        </div>
        
        <div id="artists-data" class="data-section">
            <div class="data-header">
                🎤 Your Top Artists
            </div>
            <div class="data-content">
                <div id="artists-loading" class="loading">
                    <div class="spinner"></div>
                    Loading your top artists...
                </div>
                <div id="artists-list"></div>
            </div>
        </div>
        
        <div id="genres-data" class="data-section">
            <div class="data-header">
                🎨 Your Top Genres
            </div>
            <div class="data-content">
                <div id="genres-loading" class="loading">
                    <div class="spinner"></div>
                    Loading your top genres...
                </div>
                <div id="genres-list"></div>
            </div>
        </div>
        
        <div id="popularity-data" class="data-section">
            <div class="data-header">
                📊 Your Music Popularity Score
            </div>
            <div class="data-content">
                <div id="popularity-loading" class="loading">
                    <div class="spinner"></div>
                    Calculating your popularity score...
                </div>
                <div id="popularity-score"></div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
    <script>
        // Set the user ID for the JavaScript functions
        userId = '{{ user.spotify_id }}';
    </script>
</body>
</html>